# SAMI2 论文第三节五个方程详解

## 方程 1: 离子连续性方程 (Ion Continuity Equation)

### 论文 Equation 9-10

```
∂n_i/∂t + ∇·(n_i V_i) = P_i - L_i n_i
```

### 各项含义

| 符号 | 含义 | 单位 | 说明 |
|------|------|------|------|
| **n_i** | 离子密度 | cm⁻³ | 第 i 种离子的数密度 |
| **t** | 时间 | s | 时间变量 |
| **V_i** | 离子速度 | cm/s | 离子速度矢量 (V_is, V_ip, V_iφ) |
| **P_i** | 产生率 | cm⁻³ s⁻¹ | 光致电离产生率 |
| **L_i** | 损失系数 | s⁻¹ | 化学反应 + 辐射复合损失系数 |

### 物理意义
- **∂n_i/∂t**: 密度随时间的变化率
- **∇·(n_i V_i)**: 对流项，描述离子随等离子体运动的输运
- **P_i**: 源项，主要来自太阳 EUV 光致电离
- **L_i n_i**: 汇项，包括化学反应和辐射复合

### 需要的经验模型

1. **MSIS2** - 计算 P_i（光致电离需要中性密度）
2. **EUVAC/FISM** - 计算 P_i（太阳 EUV 通量）
3. **化学反应速率** - 计算 L_i（论文 Table 4）
4. **辐射复合系数** - 计算 L_i（论文 Table 5）

---

## 方程 2: 离子动量方程 (Ion Momentum Equation)

### 论文 Equation 11-14

```
∂V_i/∂t + (V_i·∇)V_i = -1/(ρ_i)∇P_i + (e/m_i)E + (e/m_i c)V_i×B + g
                       - ν_in(V_i - V_n) - Σ_j ν_ij(V_i - V_j)
```

### 各项含义

| 符号 | 含义 | 单位 | 说明 |
|------|------|------|------|
| **V_i** | 离子速度 | cm/s | 离子速度矢量 |
| **ρ_i** | 离子质量密度 | g/cm³ | ρ_i = n_i m_i |
| **P_i** | 离子压力 | dyne/cm² | P_i = n_i k_B T_i |
| **E** | 电场 | statV/cm | 电场矢量 |
| **B** | 磁场 | Gauss | 磁场矢量 |
| **g** | 重力加速度 | cm/s² | 重力矢量 |
| **ν_in** | 离子-中性碰撞频率 | s⁻¹ | 离子与中性粒子的碰撞频率 |
| **ν_ij** | 离子-离子碰撞频率 | s⁻¹ | 离子与其他离子的碰撞频率 |
| **V_n** | 中性风速度 | cm/s | 中性大气风速 |
| **V_j** | 其他离子速度 | cm/s | 第 j 种离子的速度 |
| **e** | 基本电荷 | esu | 4.8032×10⁻¹⁰ esu |
| **m_i** | 离子质量 | g | 离子质量 |
| **c** | 光速 | cm/s | 3×10¹⁰ cm/s |

### 物理意义
- **∂V_i/∂t**: 速度随时间的变化（惯性项）
- **(V_i·∇)V_i**: 对流加速度（非线性项）
- **-1/(ρ_i)∇P_i**: 压力梯度力
- **(e/m_i)E**: 电场力
- **(e/m_i c)V_i×B**: 洛伦兹力（磁场力）
- **g**: 重力
- **-ν_in(V_i - V_n)**: 离子-中性碰撞阻力
- **-Σ_j ν_ij(V_i - V_j)**: 离子-离子碰撞阻力

### 需要的经验模型

1. **MSIS2** - 获取中性密度 n_n（计算 ν_in）
2. **HWM14** - 获取中性风速度 V_n
3. **碰撞频率公式** - 计算 ν_in 和 ν_ij（SAMI3 update 子程序）

---

## 方程 3: 电子动量方程 (Electron Momentum Equation)

### 论文 Equation 15-23

```
0 = -1/(n_e m_e)∇P_e - (e/m_e)E - (e/m_e c)V_e×B
```

### 各项含义

| 符号 | 含义 | 单位 | 说明 |
|------|------|------|------|
| **n_e** | 电子密度 | cm⁻³ | 电子数密度 |
| **m_e** | 电子质量 | g | 9.109×10⁻²⁸ g |
| **P_e** | 电子压力 | dyne/cm² | P_e = n_e k_B T_e |
| **E** | 电场 | statV/cm | 电场矢量 |
| **V_e** | 电子速度 | cm/s | 电子速度矢量 |
| **B** | 磁场 | Gauss | 磁场矢量 |

### 物理意义
- **左边 = 0**: 电子惯性可忽略（m_e 很小）
- **-1/(n_e m_e)∇P_e**: 电子压力梯度力
- **-(e/m_e)E**: 电场力
- **-(e/m_e c)V_e×B**: 洛伦兹力

### 求解结果（论文 Equation 19-23）
```
E_s = -1/n_e · b_s · ∂P_e/∂s  （沿场向电场）
V_e ≈ c(E×B)/B²  （E×B 漂移）
```

### 需要的经验模型
- **无需经验模型**（直接从方程求解）

---

## 方程 4: 离子温度方程 (Ion Temperature Equation)

### 论文 Equation 24-30

```
∂T_i/∂t + V_i·∇T_i + (2/3)T_i∇·V_i + (2/3)/(n_i k)∇·Q_i = Q_in + Q_ii + Q_ie
```

其中热流：**Q_i = -κ_i ∇T_i**

### 各项含义

| 符号 | 含义 | 单位 | 说明 |
|------|------|------|------|
| **T_i** | 离子温度 | K | 离子温度 |
| **V_i** | 离子速度 | cm/s | 离子速度矢量 |
| **Q_i** | 热流 | erg/(cm² s) | 离子热流矢量 |
| **κ_i** | 热导率 | erg/(cm s K) | 离子热导率 |
| **Q_in** | 离子-中性加热 | erg/(cm³ s) | 离子-中性碰撞加热率 |
| **Q_ii** | 离子-离子加热 | erg/(cm³ s) | 离子-离子碰撞加热率 |
| **Q_ie** | 离子-电子加热 | erg/(cm³ s) | 离子-电子碰撞加热率 |
| **k** | 玻尔兹曼常数 | erg/K | 1.38044×10⁻¹⁶ erg/K |

### 物理意义
- **∂T_i/∂t**: 温度随时间变化
- **V_i·∇T_i**: 对流项（温度平流）
- **(2/3)T_i∇·V_i**: 压缩/膨胀加热/冷却
- **(2/3)/(n_i k)∇·Q_i**: 热传导项
- **Q_in**: 与中性粒子碰撞的能量交换
- **Q_ii**: 与其他离子碰撞的能量交换
- **Q_ie**: 与电子碰撞的能量交换

### 加热项公式（论文 Equation 28-30）

**Q_in** (离子-中性):
```
Q_in = Σ_q [2m_i m_q/(m_i + m_q)²] ν_iq [k(T_q - T_i) + (1/3)m_q|V_q - V_i|²]
```

**Q_ii** (离子-离子):
```
Q_ii = Σ_j [2.2×10⁻⁴ n_j] / [A_i A_j (T_i/A_i + T_j/A_j)^(3/2)] (T_j - T_i)
```

**Q_ie** (离子-电子):
```
Q_ie = [7.7×10⁻⁶ n_e] / [A_i T_e^(3/2)] (T_e - T_i)
```

### 需要的经验模型

1. **MSIS2** - 获取中性密度 n_q 和温度 T_n（计算 Q_in）
2. **HWM14** - 获取中性风速度 V_n（计算速度差项）
3. **碰撞频率** - 计算 ν_iq（SAMI3 实现）
4. **热导率公式** - 计算 κ_i（论文 Appendix C, Equation 114-115）

---

## 方程 5: 电子温度方程 (Electron Temperature Equation)

### 论文 Equation 31-38

```
∂T_e/∂t - (2/3)/(n_e k) b_s² ∂/∂s(κ_e ∂T_e/∂s) = Q_en + Q_ei + Q_phe
```

### 各项含义

| 符号 | 含义 | 单位 | 说明 |
|------|------|------|------|
| **T_e** | 电子温度 | K | 电子温度 |
| **n_e** | 电子密度 | cm⁻³ | 电子数密度 |
| **κ_e** | 电子热导率 | erg/(cm s K) | 电子热导率 |
| **b_s** | 磁场归一化因子 | 无量纲 | b_s = B_s/B_0 |
| **Q_en** | 电子-中性加热 | erg/(cm³ s) | 电子-中性碰撞加热率 |
| **Q_ei** | 电子-离子加热 | erg/(cm³ s) | 电子-离子碰撞加热率 |
| **Q_phe** | 光电子加热 | erg/(cm³ s) | 光电子加热率 |

### 物理意义
- **∂T_e/∂t**: 电子温度随时间变化
- **-(2/3)/(n_e k)∇·Q_e**: 热传导项（沿场向）
- **Q_en**: 与中性粒子碰撞的能量交换
- **Q_ei**: 与离子碰撞的能量交换
- **Q_phe**: 光电子沉积的能量

### 加热项公式（论文 Equation 32-38）

**Q_en** (电子-中性):
```
Q_en = Σ_q [2m_e m_q/(m_e + m_q)²] ν_eq (T_q - T_e)
```

**Q_ei** (电子-离子):
```
Q_ei = Σ_j [7.7×10⁻⁶ n_j] / [A_j T_e^(3/2)] (T_j - T_e)
```

**Q_phe** (光电子加热):
- **高度 < 300 km**: 局部沉积
  ```
  Q_phe = (2/3) ε P_photo / n_e
  ε = exp[-p(x)]  （效率因子）
  ```
- **高度 > 300 km**: 非局部加热（沿场线传播）
  ```
  Q_phe = (2/3) (B/B_300) q_300 exp(-C ∫n_e dl)
  ```

### 需要的经验模型

1. **MSIS2** - 获取中性密度和温度（计算 Q_en）
2. **EUVAC/FISM** - 获取光致电离率 P_photo（计算 Q_phe）
3. **热导率公式** - 计算 κ_e（论文 Appendix C, Equation 116-120）

---

## 经验模型总结表

| 方程 | MSIS2 | HWM14 | EUVAC | 碰撞频率 | 热导率 | 化学反应 | 复合系数 |
|------|-------|-------|-------|---------|--------|---------|---------|
| **1. 离子连续性** | ✅ | ❌ | ✅ | ❌ | ❌ | ✅ | ✅ |
| **2. 离子动量** | ✅ | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ |
| **3. 电子动量** | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **4. 离子温度** | ✅ | ✅ | ❌ | ✅ | ✅ | ❌ | ❌ |
| **5. 电子温度** | ✅ | ❌ | ✅ | ❌ | ✅ | ❌ | ❌ |

---

## 关键物理过程

### 1. 光致电离 (Photoionization)
- **过程**: 太阳 EUV 光子电离中性粒子
- **公式**: `q_l(z) = n_l(z) Σ_λ σ_l^(i)(λ) φ_∞(λ) exp[-Σ_m σ_m^(a)(λ) ∫n_m ds]`
- **模型**: EUVAC (37 波段) 或 FISM (105 波段)
- **用于**: 方程 1 (产生项) 和方程 5 (光电子加热)

### 2. 化学反应 (Chemical Reactions)
- **主要反应** (论文 Table 4):
  - O⁺ + N₂ → NO⁺ + N (k₁, 温度依赖)
  - O⁺ + O₂ → O₂⁺ + O (k₂, 温度依赖)
  - 其他 19 个反应
- **用于**: 方程 1 (损失项)

### 3. 辐射复合 (Radiative Recombination)
- **过程**: 离子与电子复合
- **公式**: `α = 4.43×10⁻¹² / T_e^0.7` (O⁺)
- **用于**: 方程 1 (损失项)

### 4. 碰撞过程 (Collisions)
- **离子-中性**: 动量和能量交换
- **离子-离子**: 库仑碰撞
- **电子-中性**: 弹性碰撞
- **电子-离子**: 库仑碰撞
- **用于**: 方程 2, 4, 5

### 5. 热传导 (Thermal Conduction)
- **离子热导率**: `κ_i = 1.24×10⁴ N T_i^(5/2) / n_e`
- **电子热导率**: `κ_e = 7.7×10⁵ T_e^(5/2) / [1 + 3.22×10⁴ T_e² N_q/n_e]`
- **用于**: 方程 4, 5

---

## SAMI3 代码中的实现位置

| 物理过程 | SAMI3 文件 | 子程序/行号 |
|---------|-----------|-----------|
| **中性大气** | `neutral.f90` | `neutambt`, line 74-308 |
| **光致电离** | `photo_production.f90` | `photprod`, line 13-150 |
| **化学反应** | `chemistry.f90` | `chemrate`, line 13-207 |
| **辐射复合** | `sami3-3.22.f90` | `recorate`, line 3499-3623 |
| **碰撞频率** | `sami3-3.22.f90` | `update`, line 3330-3497 |
| **热导率** | `heating.f90` | `otemp`, `etemp`, line 238-313 |
| **E×B 漂移** | `exb_transport.f90` | `exb`, line 13-150 |

---

## 参考文献

- Huba, J. D., Joyce, G., & Fedder, J. A. (2000). SAMI2 is Another Model of the Ionosphere (SAMI2): A new low-latitude ionosphere model. *Journal of Geophysical Research: Space Physics*, 105(A10), 23035-23053.
- SAMI3 源代码：`sami3-3.22/` 目录

